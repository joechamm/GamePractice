cmake_minimum_required(VERSION 3.15)

project(Engine CXX)

include(dependicies.cmake)

if(BUILD_PLATFORM STREQUAL "Windows" OR BUILD_PLATFORM STREQUAL "Linux")
    set(ENGINE_PLATFORM_SOURCES ${CMAKE_CURRENT_SOURCE_DIR}/Platforms/Desktop)
    set(ENGINE_PLATFORM_AUDIO_SOURCES ${CMAKE_CURRENT_SOURCE_DIR}/Audio/Desktop)

    include_directories(${CMAKE_CURRENT_SOURCE_DIR}
        ${APPLICATION_INCLUDE_DIR}
        ${FREETYPE2_INCLUDE_DIR}
        ${GLFW_INCLUDE_DIR}
        ${GLAD_INCLUDE_DIR}
        ${RAPID_JSON_INCLUDE_DIR}
        ${STB_INCLUDE_DIR}
        ${OPENAL_SOFT_INCLUDE_DIR})

elseif(BUILD_PLATFORM STREQUAL "Android")
    set(ENGINE_PLATFORM_SOURCES ${CMAKE_CURRENT_SOURCE_DIR}/Platforms/Android)
    set(ENGINE_PLATFORM_AUDIO_SOURCES ${CMAKE_CURRENT_SOURCE_DIR}/Audio/Android)

    include_directories(${CMAKE_CURRENT_SOURCE_DIR}
        ${APPLICATION_INCLUDE_DIR}
        ${FREETYPE2_INCLUDE_DIR}
        ${OBOE_INCLUDE_DIR}
        ${RAPID_JSON_INCLUDE_DIR}
        ${STB_INCLUDE_DIR})

endif()

file(GLOB ENGINE_SOURCES
    ${CMAKE_CURRENT_SOURCE_DIR}/*.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/Math/*.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/Applcation/*.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/Core/*.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/UI/*.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/UI/Logics/*.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/Render/Logics/*.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/Render/*.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/Entity/*.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/Audio/*.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/Audio/Logics/*.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/Reflect/*.cpp
    ${ENGINE_PLATFORM_AUDIO_SOURCES}/*.cpp
    ${ENGINE_PLATFORM_SOURCES}/*.cpp)

file(GLOB ENGINE_HEADERS
    ${CMAKE_CURRENT_SOURCE_DIR}/*.hpp
    ${CMAKE_CURRENT_SOURCE_DIR}/Math/*.hpp
    ${CMAKE_CURRENT_SOURCE_DIR}/Applcation/*.hpp
    ${CMAKE_CURRENT_SOURCE_DIR}/Render/Logics/*.hpp
    ${CMAKE_CURRENT_SOURCE_DIR}/Render/*.hpp
    ${CMAKE_CURRENT_SOURCE_DIR}/Core/*.hpp
    ${CMAKE_CURRENT_SOURCE_DIR}/UI/*.hpp
    ${CMAKE_CURRENT_SOURCE_DIR}/UI/Logics/*.hpp
    ${CMAKE_CURRENT_SOURCE_DIR}/Entity/*.hpp
    ${CMAKE_CURRENT_SOURCE_DIR}/Audio/*.hpp
    ${CMAKE_CURRENT_SOURCE_DIR}/Audio/Logics/*.hpp
    ${ENGINE_PLATFORM_AUDIO_SOURCES}/*.hpp
    ${CMAKE_CURRENT_SOURCE_DIR}/Reflect/*.hpp
    ${ENGINE_PLATFORM_SOURCES}/*.hpp)

add_library(${PROJECT_NAME} STATIC ${ENGINE_SOURCES} ${ENGINE_HEADERS})
set_target_properties(${PROJECT_NAME} PROPERTIES COMPILE_PDB_NAME ${PROJECT_NAME})
target_compile_options(${PROJECT_NAME} PRIVATE ${CXX_APP_CHECK_FLAGS})
target_link_libraries(${PROJECT_NAME} ${ENGINE_LIB_DEPENDICIES})